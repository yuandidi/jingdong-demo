"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[883],{9174:function(t,c,e){e.d(c,{K:function(){return s}});var a=e(6768),n=e(782);const s=t=>{const c=(0,n.Pj)(),e=c.state.cartList,s=(t,e,a,n)=>{c.commit("changeCartItemInfo",{shopId:t,productId:e,productInfo:a,number:n})},o=(0,a.EW)((()=>{const c=e[t]?.productList||{},a={};for(let t in c){const e=c[t];e.count>0&&(a[t]=e)}return a})),r=(0,a.EW)((()=>{const c=e[t]?.shopName||"";return c})),i=(0,a.EW)((()=>{const c=e[t]?.productList,a={total:0,price:0,allChecked:!0};if(c)for(let t in c){const e=c[t];a.total+=e.count,e.check&&(a.price+=e.count*e.price),e.count>0&&!e.check&&(a.allChecked=!1)}return a.price=a.price.toFixed(2),a}));return{changeCartItemInfo:s,cartList:e,productList:o,shopName:r,calculations:i}}},1356:function(t,c,e){e.d(c,{A:function(){return C}});var a=e(6768),n=e(4232);const s={class:"shop"},o=["src"],r={class:"shop__content__title"},i={class:"shop__content__tags"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},_={class:"shop__content__tag"},p={class:"shop__content__highlight"};function u(t,c,e,u,h,m){return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("img",{src:e.item.imgUrl,class:"shop__img"},null,8,o),(0,a.Lk)("div",{class:(0,n.C4)(["shop__content",{"shop__content--bordered":!e.hideBorder}])},[(0,a.Lk)("div",r,(0,n.v_)(e.item.name),1),(0,a.Lk)("div",i,[(0,a.Lk)("span",l,"月售: "+(0,n.v_)(e.item.sales),1),(0,a.Lk)("span",d,"起送: "+(0,n.v_)(e.item.expressLimit),1),(0,a.Lk)("span",_,"基础运费: "+(0,n.v_)(e.item.expressPrice),1)]),(0,a.Lk)("p",p,(0,n.v_)(e.item.slogan),1)],2)])}var h={name:"ShopInfo",props:["item","hideBorder"]},m=e(1241);const k=(0,m.A)(h,[["render",u],["__scopeId","data-v-3ea6f13b"]]);var C=k},4978:function(t,c,e){e.r(c),e.d(c,{default:function(){return ut}});var a=e(6768),n=e(5130);const s={class:"wrapper"},o={class:"search"};function r(t,c,e,r,i,l){const d=(0,a.g2)("ShopInfo"),_=(0,a.g2)("Content"),p=(0,a.g2)("Cart");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",o,[(0,a.Lk)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=(...t)=>r.handleBackClick&&r.handleBackClick(...t))},""),c[1]||(c[1]=(0,a.Lk)("div",{class:"search__content"},[(0,a.Lk)("span",{class:"search__content__icon iconfont"},""),(0,a.Lk)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1))]),(0,a.bo)((0,a.bF)(d,{item:r.item,hideBorder:!0},null,8,["item"]),[[n.aG,r.item.imgUrl]]),(0,a.bF)(_,{shopName:r.item.name},null,8,["shopName"]),(0,a.bF)(p)])}var i=e(144),l=e(1387),d=e(5067),_=e(1356),p=e(4232);const u={class:"content"},h={class:"category"},m=["onClick"],k={class:"product"},C=["src"],g={class:"product__item__detail"},v={class:"product__item__title"},L={class:"product__item__sales"},I={class:"product__item__price"},f={class:"product__item__origin"},b={class:"product__number"},w=["onClick"],E=["onClick"];function P(t,c,e,n,s,o){return(0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",h,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.categories,(t=>((0,a.uX)(),(0,a.CE)("div",{class:(0,p.C4)({category__item:!0,"category__item--active":n.currentTap===t.tap}),key:t.name,onClick:()=>n.handleTapClick(t.tap)},(0,p.v_)(t.name),11,m)))),128))]),(0,a.Lk)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.list,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"product__item",key:t.id},[(0,a.Lk)("img",{class:"product__item__img",src:t.imgUrl},null,8,C),(0,a.Lk)("div",g,[(0,a.Lk)("h4",v,(0,p.v_)(t.name),1),(0,a.Lk)("p",L,"月售 "+(0,p.v_)(t.sales)+" 件",1),(0,a.Lk)("p",I,[c[0]||(c[0]=(0,a.Lk)("span",{class:"product__item__yen"},"¥",-1)),(0,a.eW)((0,p.v_)(t.price)+" ",1),(0,a.Lk)("span",f,"¥"+(0,p.v_)(t.oldPrice),1)])]),(0,a.Lk)("div",b,[(0,a.Lk)("span",{class:"product__number__minus",onClick:()=>{n.changeCartItem(n.shopId,t.id,t,-1,e.shopName)}},"-",8,w),(0,a.eW)(" "+(0,p.v_)(n.getProductCartCount(n.shopId,t.id))+" ",1),(0,a.Lk)("span",{class:"product__number__add",onClick:()=>{n.changeCartItem(n.shopId,t.id,t,1,e.shopName)}},"+",8,E)])])))),128))])])}var T=e(782),y=e(9174);const S=[{name:"全部商品",tap:"all"},{name:"秒杀",tap:"seckill"},{name:"新鲜水果",tap:"fruit"}],W=()=>{const t=(0,i.KR)(S[0].tap),c=c=>{t.value=c};return{currentTap:t,handleTapClick:c}},X=(t,c)=>{const e=(0,i.Kh)({list:[]}),n=async()=>{const a=await(0,d.J)(`/api/shop/${c}/products/${t.value}`);0===a?.error&&a?.data?.length&&(e.list=a.data)};(0,a.nT)((()=>{n()}));const{list:s}=(0,i.QW)(e);return{list:s}},K=()=>{const t=(0,T.Pj)(),{changeCartItemInfo:c,cartList:e}=(0,y.K)(),a=(c,e)=>{t.commit("changeShopName",{shopId:c,shopName:e})},n=(t,e,n,s,o)=>{c(t,e,n,s),a(t,o)},s=(t,c)=>e?.[t]?.productList?.[c]?.count||0;return{cartList:e,changeCartItem:n,getProductCartCount:s}};var F={name:"Content",props:["shopName"],setup(){const t=(0,l.lq)(),c=t.params.id,{currentTap:e,handleTapClick:a}=W(),{list:n}=X(e,c),{changeCartItem:s,cartList:o,getProductCartCount:r}=K();return{list:n,cartList:o,currentTap:e,categories:S,handleTapClick:a,shopId:c,changeCartItem:s,getProductCartCount:r}}},N=e(1241);const B=(0,N.A)(F,[["render",P],["__scopeId","data-v-cfaba924"]]);var A=B;const j={class:"cart"},H={key:0,class:"product"},M={class:"product__header"},Q=["innerHTML"],U={class:"product__header__clear"},$=["innerHTML","onClick"],q=["src"],x={class:"product__item__detail"},D={class:"product__item__title"},J={class:"product__item__price"},R={class:"product__item__origin"},G={class:"product__number"},z=["onClick"],O=["onClick"],V={class:"check"},Y={class:"check__icon"},Z={class:"check__icon__tag"},tt={class:"check__info"},ct={class:"check__info__price"},et={class:"check__btn"};function at(t,c,e,n,s,o){const r=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)(a.FK,null,[n.showCart&&n.calculations.total>0?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=(...t)=>n.handleCartShowChange&&n.handleCartShowChange(...t))})):(0,a.Q3)("",!0),(0,a.Lk)("div",j,[n.showCart&&n.calculations.total>0?((0,a.uX)(),(0,a.CE)("div",H,[(0,a.Lk)("div",M,[(0,a.Lk)("div",{class:"product__header__all",onClick:c[1]||(c[1]=()=>n.setCartItemsChecked(n.shopId))},[(0,a.Lk)("span",{class:"product__header__icon iconfont",innerHTML:n.calculations.allChecked?"":""},null,8,Q),c[4]||(c[4]=(0,a.eW)(" 全选 "))]),(0,a.Lk)("div",U,[(0,a.Lk)("span",{class:"product__header__clear__btn",onClick:c[2]||(c[2]=()=>n.cleanCartProducts(n.shopId))},"清空购物车")])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.productList,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"product__item",key:t.id},[(0,a.Lk)("div",{class:"product__item__checked iconfont",innerHTML:t.check?"":"",onClick:()=>{n.changeCartItemChecked(n.shopId,t.id)}},null,8,$),(0,a.Lk)("img",{class:"product__item__img",src:t.imgUrl},null,8,q),(0,a.Lk)("div",x,[(0,a.Lk)("h4",D,(0,p.v_)(t.name),1),(0,a.Lk)("p",J,[c[5]||(c[5]=(0,a.Lk)("span",{class:"product__item__yen"},"¥",-1)),(0,a.eW)((0,p.v_)(t.price)+" ",1),(0,a.Lk)("span",R,"¥"+(0,p.v_)(t.oldPrice),1)])]),(0,a.Lk)("div",G,[(0,a.Lk)("span",{class:"product__number__minus",onClick:()=>{n.changeCartItemInfo(n.shopId,t.id,t,-1)}},"-",8,z),(0,a.eW)(" "+(0,p.v_)(t.count||0)+" ",1),(0,a.Lk)("span",{class:"product__number__add",onClick:()=>{n.changeCartItemInfo(n.shopId,t.id,t,1)}},"+",8,O)])])))),128))])):(0,a.Q3)("",!0),(0,a.Lk)("div",V,[(0,a.Lk)("div",Y,[(0,a.Lk)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",class:"check__icon__img",onClick:c[3]||(c[3]=(...t)=>n.handleCartShowChange&&n.handleCartShowChange(...t))}),(0,a.Lk)("div",Z,(0,p.v_)(n.calculations.total),1)]),(0,a.Lk)("div",tt,[c[6]||(c[6]=(0,a.eW)(" 总计：")),(0,a.Lk)("span",ct,"¥ "+(0,p.v_)(n.calculations.price),1)]),(0,a.Lk)("div",et,[(0,a.bF)(r,{to:{path:`/orderConfirmation/${n.shopId}`}},{default:(0,a.k6)((()=>c[7]||(c[7]=[(0,a.eW)(" 去结算 ")]))),_:1},8,["to"])])])])],64)}const nt=t=>{const c=(0,T.Pj)(),{changeCartItemInfo:e,calculations:a,productList:n}=(0,y.K)(t),s=(t,e)=>{c.commit("changeCartItemChecked",{shopId:t,productId:e})},o=t=>{c.commit("cleanCartProducts",{shopId:t})},r=t=>{c.commit("setCartItemsChecked",{shopId:t})};return{calculations:a,productList:n,cleanCartProducts:o,changeCartItemInfo:e,changeCartItemChecked:s,setCartItemsChecked:r}},st=()=>{const t=(0,i.KR)(!1),c=()=>{t.value=!t.value};return{showCart:t,handleCartShowChange:c}};var ot={name:"Cart",setup(){const t=(0,l.lq)(),c=t.params.id,{calculations:e,productList:a,cleanCartProducts:n,changeCartItemInfo:s,changeCartItemChecked:o,setCartItemsChecked:r}=nt(c),{showCart:i,handleCartShowChange:d}=st();return{calculations:e,shopId:c,showCart:i,productList:a,cleanCartProducts:n,changeCartItemInfo:s,changeCartItemChecked:o,setCartItemsChecked:r,handleCartShowChange:d}}};const rt=(0,N.A)(ot,[["render",at],["__scopeId","data-v-0f6e2270"]]);var it=rt;const lt=()=>{const t=(0,i.Kh)({item:{}}),c=(0,l.lq)(),e=async()=>{const e=await(0,d.J)(`/api/shop/${c.params.id}`);0===e?.errno&&e?.data&&(t.item=e.data)},{item:a}=(0,i.QW)(t);return{item:a,getItemData:e}},dt=()=>{const t=(0,l.rd)(),c=()=>{t.back()};return{handleBackClick:c}};var _t={name:"Shop",components:{ShopInfo:_.A,Content:A,Cart:it},setup(){const{item:t,getItemData:c}=lt(),{handleBackClick:e}=dt();return c(),{item:t,handleBackClick:e}}};const pt=(0,N.A)(_t,[["render",r],["__scopeId","data-v-1d456823"]]);var ut=pt}}]);
//# sourceMappingURL=shop.2d743d5c.js.map